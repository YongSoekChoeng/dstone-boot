## WSL 호스트 환경

*   **WORK_ROOT**
    *   `/workshop`
*   **Boot Application**
    *   `%WORK_ROOT%/dstone-boot`
    *   `/conf/설정파일들`
    *   `/target/실행파일`
    *   `/01.dstone-boot-docker.yml(개별빌드용 Docker Yml)`
    *   `/02.dstone-boot-docker-reg.sh(Docker Hub 등록 명령)`
*   **Database(Mysql)**
    *   `%WORK_ROOT%/dstone-mysql`
    *   `/init-db/초기화파일들`
    *   `/target/실행파일`
    *   `/01.dstone-mysql-docker.yml(개별빌드용 Docker Yml)`
    *   `/02.dstone-mysql-docker-reg.sh(Docker Hub 등록 명령)`
*   **RabbitMq**
    *   `%WORK_ROOT%/dstone-rabbitmq`
    *   `/init-data/초기화파일`
    *   `/01.dstone-rabbitmq-docker.yml(개별빌드용 Docker Yml)`
    *   `/02.dstone-rabbitmq-docker-reg.sh(Docker Hub 등록 명령)`
*   **Redis**
    *   `%WORK_ROOT%/dstone-redis`
    *   `/01.dstone-redis-docker.yml(개별빌드용 Docker Yml)`
    *   `/02.dstone-redis-docker-reg.sh(Docker Hub 등록 명령)`
*   **Docker Compose Yml 위치**
    *   `%WORK_ROOT%/01.dstone-boot-docker-compose.yml(전체빌드용 Docker Yml)`

---

## 1. 개요

이 프로젝트는 Docker Compose를 사용하여 여러 서비스(애플리케이션, 데이터베이스, 메시지 큐, 캐시)를 함께 실행하는 구조를 가지고 있습니다. 각 서비스는 개별적으로 실행할 수도 있고, 메인 `docker-compose.yml` 파일을 통해 한 번에 실행할 수도 있습니다.

- **메인 docker-compose:** `01.dstone-boot-docker-compose.yml`은 모든 서비스를 포함하며, 서비스 간의 의존성을 정의합니다.
- **개별 docker-compose:** 각 서비스 디렉토리(`dstone-boot`, `dstone-mysql` 등)에 있는 `01.*-docker.yml` 파일들은 해당 서비스만 독립적으로 실행하기 위한 파일입니다.
- **애플리케이션 설정:** `dstone-boot/conf/application.yml` 파일은 `dstone-boot` 애플리케이션의 상세한 설정을 담고 있습니다.
- **컨테이너 등록:** `dstone-*/02.dstone-*-docker-reg.sh` 파일은 `dstone-*` 애플리케이션이 올라간 컨테이너를 Docker Hub에 이미지등록 하는 명령파일 입니다.

## 2. 메인 Docker Compose (`01.dstone-boot-docker-compose.yml`)

이 파일은 4개의 서비스와 1개의 네트워크를 정의합니다.

- **네트워크:** `dstone-network` (bridge-network)

- **서비스:**
  - **`dstone-mysql`:**
    - 이미지: `jysn007/dstone-mysql:latest`
    - 포트: `3306:3306`
    - 볼륨:
      - `mysql-data` (데이터 영속성)
      - `./dstone-mysql/init-db` (데이터베이스 초기화 스크립트)
  - **`dstone-rabbitmq`:**
    - 이미지: `jysn007/dstone-rabbitmq:latest`
    - 포트:
      - `5672:5672` (AMQP)
      - `15672:15672` (Management UI)
    - 볼륨:
      - `rabbitmq_data`, `rabbitmq_log`
      - `./dstone-rabbitmq/init-data/dstone-rabbitmq_data.json` (설정)
      - `./dstone-rabbitmq/init-data/rabbitmq.conf` (설정)
  - **`dstone-redis`:**
    - 이미지: `jysn007/dstone-redis:latest`
    - 포트: `6379:6379`
    - 볼륨: `redis_data`
  - **`dstone-boot`:**
    - 이미지: `jysn007/dstone-boot:latest`
    - 포트: `7081:7081`
    - 볼륨:
      - `dstone-boot.war` 파일
      - `conf` 디렉토리
    - **의존성:** `dstone-mysql`, `dstone-rabbitmq`, `dstone-redis`에 의존합니다.

## 3. `dstone-boot` 애플리케이션 설정 (`application.yml`)

`dstone-boot` 애플리케이션의 주요 설정은 다음과 같습니다.

- **서버:**
  - 포트: `7081`
- **데이터베이스 (Datasource):**
  - 3개의 데이터소스(`common`, `sample`, `analyzer`)가 정의되어 있습니다.
  - JDBC URL: `jdbc:log4jdbc:mysql://${DB_HOST}:${DB_PORT}/...` (환경 변수로 호스트와 포트 설정)
- **Redis:**
  - 활성화되어 있으며, Spring Session 저장소로 사용됩니다.
  - 호스트/포트: `${REDIS_HOST}`, `${REDIS_PORT}` (환경 변수)
- **RabbitMQ:**
  - 활성화되어 있습니다.
  - 호스트/포트: `${RABBITMQ_HOST}`, `${RABBITMQ_PORT}` (환경 변수)
  - 가상 호스트: `/dstone-mq`
- **보안 (Security):**
  - Spring Security가 활성화되어 있습니다.
- **기타:**
  - 메일, SFTP, 소셜 로그인(Naver, Kakao, Google) 등의 설정이 포함되어 있습니다.

## 4. 개별 Docker Compose 파일

- 각 `dstone-*` 디렉토리에 있는 `01.*-docker.yml` 파일들은 메인 `docker-compose.yml` 파일의 일부를 가져와 해당 서비스만 독립적으로 실행할 수 있도록 구성되어 있습니다.
- 이 파일들은 주로 개발 및 테스트 목적으로 사용할 수 있습니다.
